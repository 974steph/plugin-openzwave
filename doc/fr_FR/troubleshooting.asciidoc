==  Dépannage et diagnostique

=== Mon module est pas détecté ou ne remonte pas ces identifiant produit et type
image:../images/openzwave46.png[]

Lancer la Régénération de la détection du nœud depuis l'onglet Actions du module.

Si vous avez plusieurs module dans ce cas de figure, lancer *Régénérer la détection de nœuds inconnues* depuis l'écran *Réseau ZWave* onglet *Actions*.

=== Mon module est présumé mort par le contrôleur "Dead"
image:../images/openzwave42.png[]

Si le module est toujours branché et joignable, un suivre les solutions proposés dans l'écran du module.

Si le module a été décommissions ou réel défectueux, vous pouvez l'exclure du réseau en utilisant *supprimer le nœud en erreur* via onglet *Actions*.

Si le module est partie en réparation et un nouveau module de remplacement a été livré, vous pouvez lancer *Remplacer nœud en échec* via onglet *Actions*, le contrôleur déclenche l'inclusion puis vous devez procéder à l'inclusion sur le module.
L'id de l'ancien module sera conservé ainsi que ces commandes.


=== Comment utiliser la commande SwicthAll
image:../images/openzwave47.png[]

Elle est disponible via votre nœud contrôleur.
Votre contrôleur devrait avoir les commandes Swicth All On et Swicth All Off.

Si votre contrôleur n'apparait pas dans votre liste de module, lancé la synchronisation.


=== Mon module n'a pas de commande Scène ou Bouton
image:../images/openzwave54.png[]

Vous pouvez ajouter la commande dans l'écran de "mapping" des commandes.

Il s'agit d'une commande *Info* en CC *0x2b* Instance *0* commande *data[0].val*

Le mode scène doit être activé dans les paramètre du module. Voir la documentation de votre module pour plus de détails.


=== Forcer le rafraîchissement de valeurs

Il est  possible de forcer à la demande le rafraîchissement des valeurs d'une instance pour une commande classe spécifique.

Il est possible de faire via une requête http ou de créer une commande dans l'écran de mapping d'un équipement.

image:../images/openzwave56.png[]

Il s'agit d'une commande *Action* choisir la *CC* souhaité pour une *Instance* donnée avec la commande *data[0].ForceRefresh()*

L'ensemble des index de l'instance pour cette commande Classe seront mise à jour. Les nœuds sur piles, attendront leur prochain réveille avant d'effectuer la mise à jour de leur valeurs.

Vous pouvez aussi utiliser par script en lançant une requête http au serveur REST Z-Wave.

Remplacer ip_jeedom, node_id, instance_id, cc_id et index

\http://ip_jeedom:8083/ZWaveAPI/Run/devices[node_id].instances[instance_id].commandClasses[cc_id].data[index].ForceRefresh()


=== Transférer les modules sur un nouveau contrôleur
Pour différentes raisons vous pouvez être amené à devoir transférer l'ensemble de vos modules sur un nouveau contrôleur principal.

Vous décidé de passer du *raZberry* à un *Z-Stick Gen5* ou parce que, vous devez effectuer un *Reset* complet du contrôleur principal.

Voici différentes étapes pour y arriver sans perdre vos scénarios, widget et historique de valeur:

** 1) Faire un backup Jeedom.
** 2) Pensez noter (copie écran) vos valeurs de paramètres pour chaque modules, ils seront perdu suite à l'exclusion.
** 3) Dans la configuration Z-Wave décocher l'option "Supprimer automatiquement les périphériques exclus" et sauvegarder, le réseau redémarre.
** 4a) Dans le cas d'un *Reset* Faire le Reset du contrôleur principal et redémarrer le plugin.
** 4b) Pour un nouveau contrôleur, stopper Jeedom, débrancher l'ancien contrôleur et brancher le nouveau. Démarrer Jeedom.
** 5) Pour chaque équipements Z-Wave, modifier l'ID ZWave à *0*.
** 6) Ouvrir 2 pages du plugin Z-Wave dans des onglets différent.
** 7) (Via le premier onglet) Aller sur la page de configuration d'un module que vous désirez inclure au nouveau contrôleur.
** 8) (Via deuxième onglet) Faire une exclusion puis une inclusion du module. Un nouvel équipement sera créé.
** 9) Copier l'ID Z-Wave du nouvel équipement, puis supprimer cet équipement.
** 10) Retourner sur l'onglet de l'ancien module (1er onglet) puis coller le nouvel ID à la place de l'ancien ID.
** 11) Les paramètres ZWave ont étés perdue lors de l'exclusion/inclusion, pensez à remettre vos paramètres spécifique si vous n'utilisez les valeurs par défaut.
** 11) Répéter les étapes 7 à 11 pour chaque module à transférer.
** 12) A la fin vous devriez plus avoir d'équipement en ID 0.
** 13) Vérifier que tous les modules sont bien nommé dans l'écran de santé Z-Wave. Lancer la Synchronisation si ce n'est pas le cas.


=== Remplacer un module défaillant
Comment refaire l'inclusion d'un module défaillant sans perdre vos scénarios, widget et historique de valeur

Si le module est présumé "Dead" :

** Noter (copie écran) vos valeurs de paramètres, ils seront perdu suite à l'inclusion.
** Allez sur l'onglet actions du module et lancer la commande "Remplacer noeud en échec".
** Le controlleur est en mode inclusion, procéder à l'inclusion selon la documentation du module.
** Remettre vos paramètres spécifique.

Si le module n'est pas présumé "Dead" mais toujours accessible:

** Dans la configuration zwave décocher l'option "Supprimer automatiquement les périphériques exclus".
** Noter (copie écran) vos valeurs de paramètres, ils seront perdu suite à l'inclusion.
** Exclure le module défaillant.
** Aller sur la page de configuration du module défaillant.
** Ouvrir la page du plugin zwave dans un nouvel onglet.
** Faire l'inclusion du module.
** Copier l'ID du nouveau module, puis supprimer cet équipement.
** Retourner sur l'onglet de l'ancien module puis coller le nouvel ID à la place de l'ancien ID.
** Remettre vos paramètres spécifique.


=== Suppression de nœud fantôme
Si vous avez perdue toute communication avec un module sur pile et que vous souhaité l'exclure du réseau, il est possible que l'exclusion n’aboutisse pas ou que le nœud reste présent dans votre réseau.

Un assistant automatique de nœud fantôme est disponible.

** Allez sur l'onglet actions du module à supprimer.
** Il aura probablement un statu *CacheLoad*.
** Lancer la commande *Supprimer nœud fantôme*.
** Le réseau Z-Wave, ce stop, l'assistant automatique modifier le fichier *zwcfg* pour supprimer la CC WakeUp du module, le réseau redémarre.
** Fermer l'écran du module.
** Ouvrir l'écran de Santé Z-Wave.
** Attendre que le cycle de démarrage soit complété (topology loaded).
** Le module sera normalement marqué comme étant présumé mort (Dead).
** La minute suivante vous devriez voir le nœud disparaître de l'écran de santé.
** Si dans la configuration Z-Wave vous avez décoché l'option "Supprimer automatiquement les périphériques exclus", il vous faudra supprimer manuellement l'équipement correspondant.

Cette assistant est disponible seulement pour les modules sur piles.
